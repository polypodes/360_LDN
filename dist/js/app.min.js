function detectIE(){var e=window.navigator.userAgent,o=e.indexOf("MSIE "),n=e.indexOf("Trident/");if(o>0)return parseInt(e.substring(o+5,e.indexOf(".",o)),10);if(n>0){var t=e.indexOf("rv:");return parseInt(e.substring(t+3,e.indexOf(".",t)),10)}return!1}function loadpano(e){return actualpano==e?!1:($(".pano_item").removeClass("active"),$(".pano_item."+e).addClass("active"),actualpano=e,$("html").hasClass("no-touch")||$("body").removeClass("opened"),$(".titleview").text(panosTitles[e].title),$(".titleview").css("animation","none"),$(".titleview").hide(),setTimeout(function(){$(".titleview").show(),$(".titleview").css("animation","fadeIn 0.4s")},100),krpano.call("loadpano("+e+".xml, null, MERGE, BLEND(0.8));"),void krpano.call("lookto("+panosTitles[e].ltx+","+panosTitles[e].lty+",100,tween(easeOutQuad,3),true,true)"))}function changeSpot(e){loadpano(e)}function stopVideo(){player.currentTime(999),player.pause(),$("body").addClass("videofinished"),setTimeout(function(){$(".videopresentation").css("display","none")},400)}var actualpano="pano1";Modernizr.touch?$(".fs_desktop").remove():$(".fs_touch").remove();var IE=detectIE();parseInt(IE)<=8&&$("body").addClass("ie"),Modernizr.isios&&$("body").addClass("ios"),IE?($(".menu__button").on("click",function(){$("body").hasClass("opened")?$("body").removeClass("opened"):$("body").addClass("opened")}),$("#pano").on("click",function(){$("body").removeClass("opened")})):($(".menu__button").hammer({}).on("touch",function(){$("body").hasClass("opened")?$("body").removeClass("opened"):$("body").addClass("opened")}),$("#pano").hammer({}).on("touch",function(){$("body").removeClass("opened")})),$(".fs_desktop").on("click",function(){$(document).toggleFullScreen()});var viewer=embedpano({swf:"viewer/krpano.swf",xml:"xml/pano1.xml",target:"pano",html5:"prefer",passQueryParameters:!0}),krpano=document.getElementById("krpanoSWFObject"),panosTitles={pano1:{title:"Rue centrale",ltx:90,lty:0},pano2:{title:"Exterieur",ltx:190,lty:0},pano3:{title:"Salle de classe",ltx:-40,lty:0},pano4:{title:"Salle de sport",ltx:-120,lty:0}};$(".pano_item").on("click",function(){loadpano($(this).attr("data-pano"))});var player=videojs("introvideo",{controls:!0,autoplay:!0,preload:"auto"});player.on("ended",function(){stopVideo()}),$(".skip").on("click",function(){stopVideo()}),$(".sidebar__panoslist__item.video").on("click",function(){$(".videopresentation").css("display","block"),$("body").removeClass("videofinished"),player.currentTime(0),player.play()}),krpano.call("lookat("+panosTitles.pano1.ltx+","+panosTitles.pano1.lty+")");